steps:
  - wait

  - block: ':green_button: Deploy to DEV'
    prompt: 'Deploy WO to DEV environment?'
    branches: 'dev2-preprod'

  - command:
      - chmod 755 auto/build.sh
      - auto/build.sh
      - chmod 755 auto/deploy_dev.sh
      - auto/deploy_dev.sh
    label: ':package: & :rocket: Build & Deploy DEV: VERSION -> ${BUILDKITE_BUILD_NUMBER}'
    branches: dev2-preprod
    agents:
      queue: 'wo:preprod'
    retry:
      automatic:
        - exit_status: -1
          limit: 1
    env:
      BUILD_VERSION: '${BUILDKITE_BUILD_NUMBER}'
      ENV: 'dev'
      REACT_APP_SUPERSET_URL: 'https://bi-preprod.woaharvest.com'
      REACT_APP_ESTIMATES_URL: 'https://estimates-preprod.woaharvest.com'
